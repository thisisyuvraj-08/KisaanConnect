<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kisaan Connect</title>
    <link rel="stylesheet" href="kisaan.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <link href="https://fonts.googleapis.com/css?family=Montserrat:700,500,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
</head>
<body>
    <div id="authModal" class="modal animate__animated animate__fadeIn">
        <div class="modal-content glass">
            <h2 id="authTitle" data-i18n="Login">Login</h2>
            <form id="loginForm">
                <input type="text" id="loginPhone" placeholder="Phone Number" required pattern="[0-9]{10}">
                <input type="password" id="loginPassword" placeholder="Password" required>
                <button type="submit" data-i18n="Login" class="btn-primary">Login</button>
            </form>
            <p data-i18n="New user?"><button id="showRegisterBtn" type="button" data-i18n="Register" class="btn-link">Register here</button></p>
            <form id="registerForm" class="hidden">
                <input type="text" id="registerName" placeholder="Your Name" required>
                <input type="text" id="registerPhone" placeholder="Phone Number" required pattern="[0-9]{10}">
                <input type="password" id="registerPassword" placeholder="Password" required>
                <button type="submit" data-i18n="Register" class="btn-primary">Register</button>
            </form>
            <p id="showLoginLink" class="hidden" data-i18n="Already have an account?">Already have an account? <button id="showLoginBtn" type="button" data-i18n="Login" class="btn-link">Login here</button></p>
        </div>
    </div>

    <div id="roleModal" class="modal hidden animate__animated animate__fadeInDown">
        <div class="modal-content glass">
            <h2 data-i18n="Welcome to Kissan Connect">Welcome to Kisaan Connect</h2>
            <p data-i18n="Select your role:">Select your role:</p>
            <button id="farmerBtn" data-i18n="Farmer" class="btn-gradient">I am a Farmer</button>
            <button id="kiranaBtn" data-i18n="Kirana Store" class="btn-gradient-alt">I am a Kirana Store Owner</button>
        </div>
    </div>

    <header>
        <h1 data-i18n="Kisaan Connect" class="animate__animated animate__fadeInDown">Kisaan Connect</h1>
    </header>

    <main>
        <div class="top-bar">
            <div class="lang-select">
                <label for="languageDropdown" data-i18n="Language:">üåê Language:</label>
                <select id="languageDropdown">
                    <option value="en">English</option>
                    <option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</option>
                </select>
            </div>
            <button id="deleteAccountBtn" class="btn-danger" data-i18n="Delete My Account">Delete My Account</button>
        </div>

        <section id="farmerSection" class="hidden animate__animated animate__fadeInUp">
            <h2 data-i18n="Upload Your Produce">Upload Your Produce</h2>
            <form id="produceForm" class="card glass-card">
                <input type="text" id="produceName" placeholder="Produce Name" required>
                <input type="number" id="producePrice" placeholder="Price per KG" required>
                <div class="form-group">
                    <input type="number" id="produceDistance" placeholder="Visible to stores within" min="1" max="50" value="10" required>
                    <span class="input-addon">Range (km)</span>
                </div>
                <div class="form-group">
                    <label for="produceImage" class="input-label">Upload Image:</label>
                    <input type="file" id="produceImage" accept="image/*">
                </div>
                <div class="form-group">
                    <button type="button" id="snapPhotoBtn" class="btn-secondary">Snap Photo</button>
                    <video id="cameraPreview" width="160" height="120" autoplay style="display:none;margin-top:8px;border-radius:8px;"></video>
                    <canvas id="photoCanvas" width="160" height="120" style="display:none;"></canvas>
                    <img id="snappedPhoto" src="" alt="Snapped Photo" style="display:none;margin-top:8px;max-width:160px;max-height:120px;border-radius:8px;box-shadow:0 2px 10px #21915033;" />
                </div>
                <button type="submit" data-i18n="Produce" class="btn-gradient">Post Produce</button>
            </form>
            <h3 data-i18n="My Produce Posts">My Produce Posts</h3>
            <div id="myProducePosts" class="animate__animated animate__fadeIn"></div>
            <h3 data-i18n="Nearby Kirana Store Requests">Nearby Kirana Store Requests</h3>
            <div id="storeRequests" class="animate__animated animate__fadeIn"></div>
        </section>

        <section id="kiranaSection" class="hidden animate__animated animate__fadeInUp">
            <h2 data-i18n="Request Goods">Request Goods</h2>
            <form id="requestForm" class="card glass-card">
                <input type="text" id="requestName" placeholder="Requested Produce" required>
                <input type="number" id="requestQuantity" placeholder="Quantity" required>
                <div class="form-group">
                    <input type="number" id="requestDistance" placeholder="Visible to farmers within" min="1" max="50" value="10" required>
                    <span class="input-addon">Range (km)</span>
                </div>
                <button type="submit" data-i18n="Request" class="btn-gradient-alt">Post Request</button>
            </form>
            <h3 data-i18n="My Requests">My Requests</h3>
            <div id="myRequests" class="animate__animated animate__fadeIn"></div>
            <h3 data-i18n="Nearby Farmer Posts">Nearby Farmer Posts</h3>
            <div id="farmerPosts" class="animate__animated animate__fadeIn"></div>
        </section>

        <section id="mapSection">
            <h2 data-i18n="Map">Map</h2>
            <div id="map" style="height: 340px; width: 100%; border-radius: 18px; box-shadow:0 2px 12px #2d572c22;"></div>
        </section>
    </main>

    <div id="contactModal" class="modal hidden animate__animated animate__fadeIn">
        <div class="modal-content glass">
            <h2>Contact Details</h2>
            <p id="contactInfo"></p>
            <button id="whatsappBtn" class="btn-whatsapp">WhatsApp</button>
            <button id="closeContact" class="btn-secondary">Close</button>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.2/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.2/firebase-firestore-compat.js"></script>
    <script>
        // Your new Firebase config
        const firebaseConfig = {
            apiKey: "AIzaSyDnhwxpN_6VXNY2rkfKJuA5XFmSERSOFsM",
            authDomain: "kisaan-connect-da56d.firebaseapp.com",
            projectId: "kisaan-connect-da56d",
            storageBucket: "kisaan-connect-da56d.firebasestorage.app",
            messagingSenderId: "401721766160",
            appId: "1:401721766160:web:29644ebd5bcc3116f07595",
            measurementId: "G-9VQVCJYCWE"
        };
        firebase.initializeApp(firebaseConfig);
    </script>
    <script src="kisaan.js"></script>
</body>
</html>
